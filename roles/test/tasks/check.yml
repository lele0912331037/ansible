---
# --- 检测服务 ---
- name: 根据进程名称检查pid
  shell: "ps -ef|grep {{ pid_name }}||grep -v grep |awk '{print $2}'"
  register: result
  tags: check

- name: 根据pid查端口
  when: result.stdout != None
  shell: "ss -lnp|grep {{ result.stdout }}|awk 'NR=='1' {print $5}'|awk -F':' '{print $2}' && echo {{ result.stdout }} "
  tags: check

- name: 无pid时
  when: result.stdout == None
  shell: echo "进程没有启动"
